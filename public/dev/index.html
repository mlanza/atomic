<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Entities (Development)</title>
  <meta name="description" content="Entities">
  <meta name="author" content="Mario T. Lanza">
  <script src="../assets/require.js"></script>
  <script src="../assets/boot.js"></script>
  <script type="text/javascript">
    define('context', function(){
      return {};
    });
    require(["atomic"], function(atomic){ //repl use
      Object.assign(window, atomic);
    });
    /*require(["atomic", "../assets/ents"], function(atomic, ents){ //repl use
      Object.assign(window, atomic, {ents: ents});
    });*/
    require(['atomic/core', 'rxjs', 'atomic/dom', 'atomic/reactives', 'atomic/transducers'], function(_, rxjs, dom, $, t){
      var nums = $.Observable.from(_.range(5));
      var mult = $.pipe(nums, t.map(_.inc), t.take(2), t.map(_.str));
      //$.sub(nums, _.see("nums"));
      //$.sub(mult, _.see("mult"));

      var button = dom.tag('button'),
          click = button("Click Me");

      dom.append(document.body, click);

      var clicks = $.Observable.fromEvent(click, "click");
      var dos = $.pipe(clicks, t.take(2));

      $.sub(dos,
        $.observer(
          _.see("dos"),
          _.see("dos/err"),
          _.see("dos/complete")));

      Object.assign(window, {dos, mult, clicks});

      //_.reduced = $.complete; // worked with transducer!

      return;

      var uc1 = $.sub(clk, _.see("c1"));
      var uc2 = $.sub(clk, _.see("c2"));
      setTimeout(function(){
        uc1();uc2();
      }, 5000)

      var ob = $.Observable.mult(clicks);
      var oba = $.sub(ob, _.see("oba"));
      var obb = $.sub(ob, _.see("obb"));

      setTimeout(function(){
        oba(); obb();
        var obc = $.sub(ob, _.see("obc"));

      }, 5000)

      function via(xform, source){
        var sink = _.clone(source);
        return _.transduce(xform, $.pub, $.complete, sink, source);
      }

    });
  </script>
</head>
<body id="outline">
</body>
</html>